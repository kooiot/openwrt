#!/bin/sh
#
# Copyright (C) 2013-2015 OpenWrt.org
#

. /lib/functions/uci-defaults.sh

board_config_update

tlink_set_mac() {
	. /lib/functions/tlink.sh
	local eth_name="$1"
	local eth_offset="$2"
	local mac

	export_tlink_efuse_mac mac ${eth_offset} || {
		echo "Unable to load MAC from cpu efuse"
		return 1
	}
	
	ucidef_set_interface_macaddr $eth_name $mac

	return 0
}

case "$(board_name)" in
"olimex,a20-olinuxino-micro")
	ucidef_set_interface_lan 'wlan0'
	;;
"lamobo,lamobo-r1")
	ucidef_add_switch "switch0" \
		"4:lan:1" "0:lan:2" "1:lan:3" "2:lan:4" "3:wan" "8@eth0"
	;;
"xunlong,orangepi-r1")
	ucidef_set_interfaces_lan_wan "eth0" "eth1"
	;;
"kooiot,tlink-x1"|\
"kooiot,tlink-r1")
	ucidef_set_interface_lan "eth0"
	tlink_set_mac "eth0" 0
	;;
*)
	ucidef_set_interface_lan 'eth0'
	;;
esac

board_config_flush

exit 0
